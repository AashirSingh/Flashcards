"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3790],{3790:(T,u,r)=>{r.r(u),r.d(u,{PlaceDetailPageModule:()=>F});var g=r(177),m=r(4341),d=r(9384),t=r(4742),e=r(4438);const p=["f"];let h=(()=>{var i;class c{constructor(n){this.modalCtrl=n}ngOnInit(){const n=new Date(this.selectedPlace.availableFrom),o=new Date(this.selectedPlace.availableTo);"random"===this.selectedMode&&(this.startDate=new Date(n.getTime()+Math.random()*(o.getTime()-6048e5-n.getTime())).toISOString(),this.endDate=new Date(new Date(this.startDate).getTime()+Math.random()*(new Date(this.startDate).getTime()+5184e5-new Date(this.startDate).getTime())).toISOString())}onCancel(){this.modalCtrl.dismiss(null,"cancel")}onBookPlace(){!this.form.valid||!this.datesValid||this.modalCtrl.dismiss({bookingData:{firstName:this.form.value["first-name"],lastName:this.form.value["last-name"],guestNumber:+this.form.value["guest-number"],startDate:new Date(this.form.value["date-from"]),endDate:new Date(this.form.value["date-to"])}},"confirm")}datesValid(){const n=new Date(this.form.value["date-from"]);return new Date(this.form.value["date-to"])>n}}return(i=c).\u0275fac=function(n){return new(n||i)(e.rXU(t.W3))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-create-booking"]],viewQuery:function(n,o){if(1&n&&e.GBs(p,7),2&n){let s;e.mGM(s=e.lsd())&&(o.form=s.first)}},inputs:{selectedPlace:"selectedPlace",selectedMode:"selectedMode"},decls:52,vars:9,consts:[["f","ngForm"],["startDateCtrl","ngModel"],["slot","primary"],[3,"click"],["name","close"],["padding","",1,"ion-text-center"],[3,"ngSubmit"],["size-sm","6","offset-sm","3"],["position","floating"],["type","text","ngModel","","name","first-name","required",""],["type","text","ngModel","","name","last-name","required",""],["name","guest-number",3,"ngModel"],["value","1"],["value","2"],["value","3"],["size-sm","3","offset-sm","3"],["display-format","MMM DD YYYY","picker-format","YY MMM DD","name","date-from","required","",3,"min","max","ngModel"],["display-format","MMM DD YYYY","picker-format","YY MMM DD","name","date-to","required","",3,"min","max","ngModel"],["type","submit","color","primary","expand","block",3,"disabled"]],template:function(n,o){if(1&n){const s=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",2)(5,"ion-button",3),e.bIt("click",function(){return e.eBV(s),e.Njj(o.onCancel())}),e.nrm(6,"ion-icon",4),e.k0s()()()(),e.j41(7,"ion-content",5)(8,"form",6,0),e.bIt("ngSubmit",function(){return e.eBV(s),e.Njj(o.onBookPlace())}),e.j41(10,"ion-grid")(11,"ion-row")(12,"ion-col",7)(13,"ion-item")(14,"ion-label",8),e.EFF(15,"First Name"),e.k0s(),e.nrm(16,"ion-input",9),e.k0s()()(),e.j41(17,"ion-row")(18,"ion-col",7)(19,"ion-item")(20,"ion-label",8),e.EFF(21,"Last Name"),e.k0s(),e.nrm(22,"ion-input",10),e.k0s()()(),e.j41(23,"ion-row")(24,"ion-col",7)(25,"ion-item")(26,"ion-label",8),e.EFF(27,"Number of Guests"),e.k0s(),e.j41(28,"ion-select",11)(29,"ion-select-option",12),e.EFF(30,"1"),e.k0s(),e.j41(31,"ion-select-option",13),e.EFF(32,"2"),e.k0s(),e.j41(33,"ion-select-option",14),e.EFF(34,"3"),e.k0s()()()()(),e.j41(35,"ion-row")(36,"ion-col",15)(37,"ion-item")(38,"ion-label",8),e.EFF(39,"From"),e.k0s(),e.nrm(40,"ion-datetime",16,1),e.k0s()()(),e.j41(42,"ion-row")(43,"ion-col",15)(44,"ion-item")(45,"ion-label",8),e.EFF(46,"To"),e.k0s(),e.nrm(47,"ion-datetime",17),e.k0s()()(),e.j41(48,"ion-row")(49,"ion-col",7)(50,"ion-button",18),e.EFF(51," Book! "),e.k0s()()()()()()}if(2&n){const s=e.sdS(9),l=e.sdS(41);e.R7$(3),e.JRh(o.selectedPlace.title),e.R7$(25),e.Y8G("ngModel","2"),e.R7$(12),e.Y8G("min",o.selectedPlace.availableFrom.toISOString())("max",o.selectedPlace.availableTo.toISOString())("ngModel",o.startDate),e.R7$(7),e.Y8G("min",l.value)("max",o.selectedPlace.availableTo.toISOString())("ngModel",o.endDate),e.R7$(3),e.Y8G("disabled",!s.valid||!o.datesValid())}},dependencies:[m.qT,m.BC,m.cb,m.YS,m.vS,m.cV,t.Jm,t.QW,t.hU,t.W9,t.A9,t.lO,t.eU,t.iq,t.$w,t.uz,t.he,t.ln,t.Nm,t.Ip,t.BC,t.ai,t.Je,t.Gw]}),c})();var f=r(2872),b=r(8591),D=r(3379),k=r(5709);function v(i,c){1&i&&(e.j41(0,"div",4),e.nrm(1,"ion-spinner",5),e.k0s())}function P(i,c){if(1&i){const a=e.RV6();e.j41(0,"ion-row")(1,"ion-col",11)(2,"ion-button",12),e.bIt("click",function(){e.eBV(a);const o=e.XpG(2);return e.Njj(o.onBookPlace())}),e.EFF(3,"Book"),e.k0s()()()}}function C(i,c){if(1&i&&(e.j41(0,"ion-grid",6)(1,"ion-row")(2,"ion-col",7),e.nrm(3,"ion-img",8),e.k0s()(),e.j41(4,"ion-row")(5,"ion-col",9)(6,"p"),e.EFF(7),e.k0s()()(),e.j41(8,"ion-row"),e.nrm(9,"ion-col",9),e.k0s(),e.DNE(10,P,4,0,"ion-row",10),e.k0s()),2&i){const a=e.XpG();e.R7$(3),e.Y8G("src",null==a.place?null:a.place.imageUrl),e.R7$(4),e.JRh(null==a.place?null:a.place.description),e.R7$(3),e.Y8G("ngIf",a.isBookable)}}const M=[{path:"",component:(()=>{var i;class c{constructor(n,o,s,l,B,S,j,I,w,Y){this.navCtrl=n,this.route=o,this.placesService=s,this.modalCtrl=l,this.actionSheetCtrl=B,this.bookingService=S,this.loadingCtrl=j,this.authService=I,this.alertCtrl=w,this.router=Y,this.isBookable=!1,this.isLoading=!1}ngOnInit(){this.route.paramMap.subscribe(n=>{const o=n.get("placeId");o?(this.isLoading=!0,this.placeSub=this.placesService.getPlace(o).subscribe(s=>{this.place=s,this.userIdSub=this.authService.userId.subscribe(l=>{this.isBookable=l!==s.userId,this.isLoading=!1})},s=>{this.alertCtrl.create({header:"An error occurred!",message:"Could not load place.",buttons:[{text:"Okay",handler:()=>{this.router.navigate(["/places/tabs/discover"])}}]}).then(l=>l.present())})):this.navCtrl.navigateBack("/places/tabs/discover")})}onBookPlace(){this.actionSheetCtrl.create({header:"Choose an Action",buttons:[{text:"Select Date",handler:()=>{this.openBookingModal("select")}},{text:"Random Date",handler:()=>{this.openBookingModal("random")}},{text:"Cancel",role:"cancel"}]}).then(n=>{n.present()})}openBookingModal(n){console.log(n),this.modalCtrl.create({component:h,componentProps:{selectedPlace:this.place,selectedMode:n}}).then(o=>(o.present(),o.onDidDismiss())).then(o=>{"confirm"===o.role&&this.loadingCtrl.create({message:"Booking place..."}).then(s=>{s.present();const l=o.data.bookingData;this.bookingService.addBooking(this.place.id,this.place.title,this.place.imageUrl,l.firstName,l.lastName,l.guestNumber,l.startDate,l.endDate).subscribe(()=>{s.dismiss()})})})}ngOnDestroy(){this.placeSub&&this.placeSub.unsubscribe()}}return(i=c).\u0275fac=function(n){return new(n||i)(e.rXU(f.q9),e.rXU(d.nX),e.rXU(b._),e.rXU(t.W3),e.rXU(t.GD),e.rXU(D.L),e.rXU(t.Xi),e.rXU(k.u),e.rXU(t.hG),e.rXU(d.Ix))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-place-detail"]],decls:9,vars:3,consts:[["slot","start"],["defaultHref","/places/tabs/discover"],["class","ion-text-center",4,"ngIf"],["class","ion-no-padding",4,"ngIf"],[1,"ion-text-center"],["color","primary"],[1,"ion-no-padding"],["size-sm","6","offset-sm","3",1,"ion-no-padding"],[3,"src"],["size-sm","6","offset-sm","3","padding","",1,"ion-text-center"],[4,"ngIf"],["size-sm","6","offset-sm","3",1,"ion-text-center"],["color","primary","margin","",3,"click"]],template:function(n,o){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button",1),e.k0s(),e.j41(4,"ion-title"),e.EFF(5),e.k0s()()(),e.j41(6,"ion-content"),e.DNE(7,v,2,0,"div",2)(8,C,11,3,"ion-grid",3),e.k0s()),2&n&&(e.R7$(5),e.JRh(o.isLoading?"Loading...":null==o.place?null:o.place.title),e.R7$(2),e.Y8G("ngIf",o.isLoading),e.R7$(),e.Y8G("ngIf",!o.isLoading))},dependencies:[g.bT,t.Jm,t.QW,t.hU,t.W9,t.lO,t.eU,t.KW,t.ln,t.w2,t.BC,t.ai,t.el]}),c})()}];let F=(()=>{var i;class c{}return(i=c).\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[g.MD,m.YN,t.bv,d.iI.forChild(M)]}),c})()}}]);