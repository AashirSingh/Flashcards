"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7082],{7082:($,p,c)=>{c.r(p),c.d(p,{NewOfferPageModule:()=>M});var f=c(177),r=c(4341),u=c(5171),i=c(4742),o=c(3953);let g=(()=>{var e;class s{}return(e=s).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[f.MD,i.bv]}),s})();var k=c(8591),h=c(5558),v=c(6354),P=c(7673),b=c(2276),d=c(5312),w=c(1626);function F(e,s){1&e&&o.nrm(0,"ion-spinner",4)}function C(e,s){if(1&e){const a=o.RV6();o.j41(0,"ion-img",5),o.bIt("click",function(){o.eBV(a);const n=o.XpG();return o.Njj(n.onPickLocation())}),o.k0s()}if(2&e){const a=o.XpG();o.Y8G("src",a.selectedLocationImage)}}function L(e,s){if(1&e){const a=o.RV6();o.j41(0,"ion-button",6),o.bIt("click",function(){o.eBV(a);const n=o.XpG();return o.Njj(n.onPickLocation())}),o.nrm(1,"ion-icon",7),o.j41(2,"ion-label"),o.EFF(3,"Select Location"),o.k0s()()}}let j=(()=>{var e;class s{constructor(t,n){this.modalCtrl=t,this.http=n,this.locationPick=new o.bkB,this.isLoading=!1}ngOnInit(){}onPickLocation(){this.modalCtrl.create({component:b.z}).then(t=>{t.onDidDismiss().then(n=>{if(!n.data)return;const l={lat:n.data.lat,lng:n.data.lng,address:null,staticMapImageUrl:null};this.isLoading=!0,this.getAddress(n.data.lat,n.data.lng).pipe((0,h.n)(m=>(l.address=m,(0,P.of)(this.getMapImage(l.lat,l.lng,14))))).subscribe(m=>{l.staticMapImageUrl=m,this.selectedLocationImage=m,this.isLoading=!1,this.locationPick.emit(l)})}),t.present()})}getAddress(t,n){return this.http.get(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${t},${n}&key=${d.c.googleMapsAPIKey}`).pipe((0,v.T)(l=>l&&l.results&&0!==l.results.length?l.results[0].formatted_address:null))}getMapImage(t,n,l){return`https://maps.googleapis.com/maps/api/staticmap?center=${t},${n}&zoom=${l}&size=500x300&maptype=roadmap\n    &markers=color:red%7Clabel:Place%7C${t},${n}\n    &key=${d.c.googleMapsAPIKey}`}}return(e=s).\u0275fac=function(t){return new(t||e)(o.rXU(i.W3),o.rXU(w.Qq))},e.\u0275cmp=o.VBU({type:e,selectors:[["app-location-picker"]],outputs:{locationPick:"locationPick"},decls:4,vars:3,consts:[[1,"picker"],["color","primary",4,"ngIf"],["role","button","class","location-image",3,"src","click",4,"ngIf"],["color","primary",3,"click",4,"ngIf"],["color","primary"],["role","button",1,"location-image",3,"click","src"],["color","primary",3,"click"],["name","map","slot","start"]],template:function(t,n){1&t&&(o.j41(0,"div",0),o.DNE(1,F,1,0,"ion-spinner",1)(2,C,1,1,"ion-img",2)(3,L,4,0,"ion-button",3),o.k0s()),2&t&&(o.R7$(),o.Y8G("ngIf",n.isLoading),o.R7$(),o.Y8G("ngIf",n.selectedLocationImage&&!n.isLoading),o.R7$(),o.Y8G("ngIf",!n.selectedLocationImage&&!n.isLoading))},dependencies:[f.bT,i.Jm,i.iq,i.KW,i.he,i.w2]}),s})();function N(e,s){1&e&&(o.j41(0,"ion-row")(1,"ion-col",6)(2,"p"),o.EFF(3,"Description must be between 1 and 180 characters."),o.k0s()()())}function I(e,s){if(1&e&&(o.j41(0,"ion-row")(1,"ion-col",6)(2,"ion-item")(3,"ion-label"),o.EFF(4,"Location: "),o.k0s(),o.j41(5,"p"),o.EFF(6),o.k0s()(),o.j41(7,"ion-item")(8,"ion-label"),o.EFF(9,"Latitude: "),o.k0s(),o.j41(10,"p"),o.EFF(11),o.k0s()(),o.j41(12,"ion-item")(13,"ion-label"),o.EFF(14,"Longitude: "),o.k0s(),o.j41(15,"p"),o.EFF(16),o.k0s()()()()),2&e){const a=o.XpG();o.R7$(6),o.JRh(a.form.get("location").value.address),o.R7$(5),o.JRh(a.form.get("location").value.lat),o.R7$(5),o.JRh(a.form.get("location").value.lng)}}const O=[{path:"",component:(()=>{var e;class s{constructor(t,n,l){this.placesService=t,this.router=n,this.loadingCtrl=l}ngOnInit(){this.form=new r.gE({title:new r.MJ(null,{updateOn:"blur",validators:[r.k0.required]}),description:new r.MJ(null,{updateOn:"blur",validators:[r.k0.required,r.k0.maxLength(180)]}),price:new r.MJ(null,{updateOn:"blur",validators:[r.k0.required,r.k0.min(1)]}),dateFrom:new r.MJ(null,{updateOn:"blur",validators:[r.k0.required]}),dateTo:new r.MJ(null,{updateOn:"blur",validators:[r.k0.required]})})}onLocationPicked(t){this.form.patchValue({location:t})}onCreateOffer(){this.form.valid&&this.loadingCtrl.create({message:"Creating place..."}).then(t=>{t.present(),this.placesService.addPlace(this.form.value.title,this.form.value.description,this.form.value.price,new Date(this.form.value.dateFrom),new Date(this.form.value.dateTo),this.form.value.location).subscribe(()=>{t.dismiss(),this.form.reset(),this.router.navigate(["/places/tabs/offers"])})})}}return(e=s).\u0275fac=function(t){return new(t||e)(o.rXU(k._),o.rXU(u.Ix),o.rXU(i.Xi))},e.\u0275cmp=o.VBU({type:e,selectors:[["app-new-offer"]],decls:46,vars:4,consts:[["slot","start"],["defaultHref","/places/tabs/offers"],["slot","primary"],[3,"click","disabled"],["name","checkmark","slot","icon-only"],[3,"formGroup"],["size-sm","6","offset-sm","3"],["position","floating"],["type","text","autocomplete","","autocorrect","","formControlName","title"],["rows","3","formControlName","description"],[4,"ngIf"],["type","number","formControlName","price"],["size-sm","3","offset-sm","3"],["min","2019-01-01","max","2025-12-31","formControlName","dateFrom"],["size-sm","3"],["min","2019-01-02","max","2025-12-31","formControlName","dateTo"],[3,"locationPick"]],template:function(t,n){1&t&&(o.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),o.nrm(3,"ion-back-button",1),o.k0s(),o.j41(4,"ion-title"),o.EFF(5,"New Offer"),o.k0s(),o.j41(6,"ion-buttons",2)(7,"ion-button",3),o.bIt("click",function(){return n.onCreateOffer()}),o.nrm(8,"ion-icon",4),o.k0s()()()(),o.j41(9,"ion-content")(10,"form",5)(11,"ion-grid")(12,"ion-row")(13,"ion-col",6)(14,"ion-item")(15,"ion-label",7),o.EFF(16,"Title"),o.k0s(),o.nrm(17,"ion-input",8),o.k0s()()(),o.j41(18,"ion-row")(19,"ion-col",6)(20,"ion-item")(21,"ion-label",7),o.EFF(22,"Short Description"),o.k0s(),o.nrm(23,"ion-textarea",9),o.k0s()()(),o.DNE(24,N,4,0,"ion-row",10),o.j41(25,"ion-row")(26,"ion-col",6)(27,"ion-item")(28,"ion-label",7),o.EFF(29,"Price"),o.k0s(),o.nrm(30,"ion-input",11),o.k0s()()(),o.j41(31,"ion-row")(32,"ion-col",12)(33,"ion-item")(34,"ion-label",7),o.EFF(35,"Available from"),o.k0s(),o.nrm(36,"ion-datetime",13),o.k0s()(),o.j41(37,"ion-col",14)(38,"ion-item")(39,"ion-label",7),o.EFF(40,"Available to"),o.k0s(),o.nrm(41,"ion-datetime",15),o.k0s()()(),o.j41(42,"ion-row")(43,"ion-col",6)(44,"app-location-picker",16),o.bIt("locationPick",function(m){return n.onLocationPicked(m)}),o.k0s()()(),o.DNE(45,I,17,3,"ion-row",10),o.k0s()()()),2&t&&(o.R7$(7),o.Y8G("disabled",!n.form.valid),o.R7$(3),o.Y8G("formGroup",n.form),o.R7$(14),o.Y8G("ngIf",!n.form.get("description").valid&&n.form.get("description").touched),o.R7$(21),o.Y8G("ngIf",n.form.get("location").value))},dependencies:[f.bT,r.qT,r.BC,r.cb,i.Jm,i.QW,i.hU,i.W9,i.A9,i.lO,i.eU,i.iq,i.$w,i.uz,i.he,i.ln,i.nc,i.BC,i.ai,i.su,i.Je,i.Gw,i.el,r.j4,r.JD,j]}),s})()}];let M=(()=>{var e;class s{}return(e=s).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[f.MD,r.YN,i.bv,u.iI.forChild(O),r.X1,g]}),s})()}}]);